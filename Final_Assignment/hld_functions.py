#This file contains the functions that have been derived from the graphs in the Roskam book.
#They are used in the HldSize class.


def K(cfc,flaptype):
    if flaptype == 1:
        K = 0.9965977514013269 - 0.2361378504651011*cfc - 9.574408734711309*cfc**2 + 154.13435271017116*cfc**3 - 1361.575512976779*cfc**4 + 5986.884155081507*cfc**5 - 14771.660609524113*cfc**6 + 21647.67114925106*cfc**7 - 18775.583782210037*cfc**8 + 8921.216331880963*cfc**9 - 1792.2761193962122*cfc**10
    elif flaptype == 2:
        K = +1.0197859892298546 - 4.461814518987685*cfc + 201.14009313153963*cfc**2 - 3887.5193010319476*cfc**3 + 39589.18546244581*cfc**4 - 240188.73231553528*cfc**5 + 933314.8148926334*cfc**6 - 2430522.1381957964*cfc**7 + 4344128.333540949*cfc**8 - 5354144.836451614*cfc**9 + 4479079.085437146*cfc**10 - 2431271.843850071*cfc**11 + 773084.2942469091*cfc**12 - 109378.33950672453*cfc**13
    elif flaptype == 3:
        K = +1.0147803271268045 - 4.072322475905859*cfc + 151.30406420546583*cfc**2 - 2319.923573137477*cfc**3 + 18541.234480106003*cfc**4 - 86537.08234331118*cfc**5 + 250337.53159266466*cfc**6 - 462869.8668286367*cfc**7 + 548489.9154901103*cfc**8 - 403409.3128552746*cfc**9 + 167807.662433221*cfc**10 - 30188.43079448096*cfc**11
    return K

def cldf(cfc,tc):
    cldf0 = +1.867933437131989 - 28.818143442662794*cfc + 980.439890605035*cfc**2 - 12210.9567088771*cfc**3 + 90074.60055275563*cfc**4 - 420636.6280521493*cfc**5 + 1260542.8682880108*cfc**6 - 2383938.744879943*cfc**7 + 2693116.1235260633*cfc**8 - 1596982.1038901892*cfc**9 + 350005.8135793239*cfc**10
    cldf15 = +1.339808877184416 - 28.61627236882045*cfc + 1786.1550064216156*cfc**2 - 34850.068087757405*cfc**3 + 400636.35690908437*cfc**4 - 2964287.5515134735*cfc**5 + 14581167.716347404*cfc**6 - 48051891.339694716*cfc**7 + 104651217.550269*cfc**8 - 144302287.62971696*cfc**9 + 113987185.77506736*cfc**10 - 39263278.49826307*cfc**11
    return  (cldf15-cldf0)*tc/0.15 + cldf0


def Kprime(df,cfc):
    kprime50 = +48.06207352390338 -20.677682453134608*df +3.9341354695698993*df**2 -0.42909946281606776*df**3 +0.029994305889758485*df**4 -0.0014233434246905317*df**5 +4.7255639964681204e-05*df**6 -1.1107663797238105e-06*df**7 +1.8412682003296522e-08*df**8 -2.1056523852898446e-10*df**9 +1.5810434145295228e-12*df**10 -7.014392957210318e-15*df**11 +1.3933247244825724e-17*df**12
    kprime10 = +1.670460872528836 - 0.12950413814634962*df - 0.0053451975511979765*df**2 + 0.003381527352575111*df**3 - 0.00037156417677378274*df**4 + 2.035827904496566e-05*df**5 - 6.531248680443325e-07*df**6 + 1.2834977287046376e-08*df**7 - 1.5239309709809558e-10*df**8 + 1.0053890556634838e-12*df**9 - 2.8329422237904962e-15*df**10
    return (kprime50-kprime10)/(0.50-0.10)*cfc + kprime10 - (kprime50-kprime10)/(0.50-0.10)*0.10

def adf(df,cfc):
    adf15 = +0.3757710635593408 - 0.007365977757770546*df + 0.004716321725982575*df**2 - 0.0013667148868971941*df**3 + 0.0002272144680602197*df**4 - 2.439647339636509e-05*df**5 + 1.7892212566260895e-06*df**6 - 9.24970288061637e-08*df**7 + 3.4306753596738356e-09*df**8 - 9.20238902958059e-11*df**9 + 1.783576300264834e-12*df**10 - 2.4692813309214948e-14*df**11 + 2.378061156152546e-16*df**12 - 1.5120993709966578e-18*df**13 + 5.703421560637633e-21*df**14 - 9.66036701778895e-24*df**15
    adf40 = +0.60399332347105 +0.020093001199135953*df -0.0154632359642434*df**2 +0.004837887465963251*df**3 -0.0008390947830503297*df**4 +9.173195087885656e-05*df**5 -6.797749777948913e-06*df**6 +3.5681065146911756e-07*df**7 -1.3626417603204756e-08*df**8 +3.8426307467424834e-10*df**9 -8.042374686712891e-12*df**10 +1.2439662424431715e-13*df**11 -1.4008775001833345e-15*df**12 +1.1146684993841014e-17*df**13 -5.928687633495545e-20*df**14 +1.8880694469649646e-22*df**15 -2.7177826238555684e-25*df**16
    return (adf40-adf15)/(0.40-0.15)*cfc + adf15 - (adf40-adf15)/(0.40-0.15)*0.15

def cldelta(cfc):
    cldelta = +3.187485777367157e-05 -0.003212154462921577*cfc +2.0174989654479774*cfc**2 -105.14703455390055*cfc**3 +2832.710657095351*cfc**4 -45320.37556992296*cfc**5 +472346.03425492224*cfc**6 -3383733.834952366*cfc**7 +17185329.767991547*cfc**8 -62822203.91049494*cfc**9 +165530343.36955878*cfc**10 -310128924.9277424*cfc**11 +398915111.3108149*cfc**12 -326384959.3637212*cfc**13 +139467871.60246977*cfc**14 -7517484.046122727*cfc**15 -11584878.119807463*cfc**16
    return cldelta